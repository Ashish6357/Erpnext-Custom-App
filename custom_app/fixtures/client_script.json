[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Invoice",
  "enabled": 1,
  "modified": "2025-06-11 21:47:01.352583",
  "module": "Custom Changes",
  "name": "Sales Invoice",
  "script": "frappe.ui.form.on('Sales Invoice', {\r\n    onload: function(frm) {\r\n        cur_frm.set_query('customer', () => {\r\n            return {\r\n                filters: {\r\n                    customer_group: 'Dieture Subscribers'\r\n                }\r\n            };\r\n        });\r\n    }\r\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Invoice",
  "enabled": 1,
  "modified": "2025-06-11 21:12:54.994343",
  "module": "Custom Changes",
  "name": "Purchase Invoice",
  "script": "frappe.ui.form.on('Purchase Invoice', {\n\trefresh(frm) {\n\t\t// your code here\n\t}\n})\n\nfrappe.ui.form.on('Purchase Invoice Item', {\n    item_code: function(frm, cdt, cdn) {\n        let row = locals[cdt][cdn];\n\n        if (!row.item_code) return;\n\n        frappe.call({\n            method: \"custom_app.custom_changes.custom_python.get_last_purchase_rates\",\n            args: {\n                item_code: row.item_code\n            },\n            callback: function(r) {\n                if (r.message && r.message.length > 0) {\n                    const rates = r.message;\n                    console.log(rates, \"rates\")\n                    let highest = Math.max(...rates.map(r => r.base_rate));\n                    let html = `<div style=\"padding: 8px;\"><strong>Last 3 Purchase Rates:</strong><ul style=\"margin: 4px;\">`;\n\n                    rates.forEach(rate => {\n                        let color = rate.base_rate === highest ? 'red' : 'inherit';\n                        html += `<li><span style=\"color:${color}; font-weight: bold;\">\u20b9${rate.base_rate}</span> (on ${frappe.datetime.str_to_user(rate.posting_date)})</li>`;\n                    });\n\n                    html += `</ul></div>`;\n\n                    frappe.msgprint({\n                        title: __('Recent Purchase Rates'),\n                        message: html,\n                        indicator: 'blue'\n                    });\n                }\n            }\n        });\n    }\n});\n",
  "view": "Form"
 }
]